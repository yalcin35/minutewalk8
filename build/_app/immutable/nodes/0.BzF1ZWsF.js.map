{"version":3,"file":"0.BzF1ZWsF.js","sources":["../../../../../../src/routes/+layout.ts","../../../../../../src/routes/+layout.svelte"],"sourcesContent":["import { browser } from '$app/environment';\nimport { initI18n } from '$lib/i18n';\n\n// Initialize i18n as early as possible\n// Initialize i18n as early as possible\nexport const load = async () => {\n  if (browser) {\n    initI18n();\n  }\n  \n  return {};\n};","<script lang=\"ts\">\n  import '../app.css';\n  import { onMount, onDestroy } from 'svelte';\n  import { goto } from '$app/navigation';\n  import { page } from '$app/stores';\n  import { get } from 'svelte/store';\n  import { user, isLoading } from '$lib/supabase';\n  import Sidebar from '$lib/components/Sidebar.svelte';\n  \n  const publicRoutes = ['/', '/signin', '/pricing', '/privacy', '/contact'];\n  \n  let isSidebarOpen = true;\n  let currentPath = '';\n  let unsubscribeUser: () => void;\n  let initialized = false;\n  \n  onMount(() => {\n    try {\n      const savedState = localStorage.getItem('sidebarOpen');\n      isSidebarOpen = savedState ? JSON.parse(savedState) : true;\n    } catch (e) {\n      console.error('LocalStorage error:', e);\n    }\n    \n    unsubscribeUser = user.subscribe(($user) => {\n      if (!initialized || get(isLoading)) return;\n      \n      try {\n        const $pageValue = get(page);\n        const path = ($pageValue?.url?.pathname || '/').split('?')[0];\n        const isPublicRoute = publicRoutes.includes(path);\n        \n        if (!$user && !isPublicRoute) {\n          goto('/signin');\n        } else if ($user && path === '/signin') {\n          goto('/dashboard');\n        }\n      } catch (error) {\n        console.error('Auth state change error:', error);\n      }\n    });\n    \n    setTimeout(() => initialized = true, 100);\n  });\n  \n  onDestroy(() => {\n    if (unsubscribeUser) unsubscribeUser();\n  });\n  \n  $: {\n    try {\n      if (typeof window !== 'undefined') {\n        localStorage.setItem('sidebarOpen', JSON.stringify(isSidebarOpen));\n      }\n    } catch (e) {\n      console.error('LocalStorage error:', e);\n    }\n  }\n  \n  $: {\n    try {\n      currentPath = (get(page)?.url?.pathname || '').split('?')[0];\n    } catch (e) {\n      currentPath = '';\n      console.error('Page store error:', e);\n    }\n  }\n  \n  $: isPublicRoute = publicRoutes.includes(currentPath);\n</script>\n\n<div class=\"min-h-screen flex flex-col\">\n  {#if !initialized || get(isLoading)}\n    <div class=\"flex items-center justify-center h-screen\">\n      <div class=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"></div>\n    </div>\n  {:else if get(user) && !isPublicRoute}\n    <Sidebar bind:isOpen={isSidebarOpen} />\n    <div class={`transition-all duration-300 ${isSidebarOpen ? 'ml-64' : 'ml-20'}`}>\n      <main class=\"flex-1\">\n        <slot />\n      </main>\n    </div>\n  {:else}\n    <main class=\"flex-1\">\n      <slot />\n    </main>\n  {/if}\n</div>"],"names":["$.mutable_source","$.set","$.get","get","isPublicRoute"],"mappings":";;;;;;;;;AAKO,MAAM,OAAO,YAAY;AACjB;AACF,aAAA;AAAA,EAAA;AAGX,SAAO,CAAC;AACV;;;;;;;;;;;;ACFQ,QAAA,eAAA;AAAA,IAAgB;AAAA,IAAK;AAAA,IAAW;AAAA,IAAY;AAAA,IAAY;AAAA;MAE1D,gBAAgBA,eAAA,IAAA;MAChB,cAAcA,eAAA,EAAA;AACd,MAAA;MACA,cAAcA,eAAA,KAAA;AAElB,UAAc,MAAA;AACR,QAAA;YACI,aAAa,aAAa,QAAQ,aAAa;AACrDC,UAAA,eAAgB,aAAa,KAAK,MAAM,UAAU,IAAI,IAAA;AAAA,IACxD,SAAS,GAAG;AACV,cAAQ,MAAM,uBAAuB,CAAC;AAAA,IACxC;AAEA,sBAAkB,KAAK,WAAW,UAAU;;AACrC,UAAA,CAAAC,IAAA,WAAA,KAAeC,MAAI,SAAS,EAAA;AAE7B,UAAA;AACI,cAAA,aAAaA,MAAI,IAAI;AACrB,cAAA,UAAQ,8CAAY,QAAZ,mBAAiB,aAAY,KAAK,MAAM,GAAG,EAAE,CAAC;cACtDC,iBAAgB,aAAa,SAAS,IAAI;AAE3C,YAAA,CAAA,SAAA,CAAUA,gBAAe;AAC5B,eAAK,SAAS;AAAA,mBACL,SAAS,SAAS,WAAW;AACtC,eAAK,YAAY;AAAA,QACnB;AAAA,MACF,SAAS,OAAO;AACd,gBAAQ,MAAM,4BAA4B,KAAK;AAAA,MACjD;AAAA,KACD;AAED,eAAiB,MAAAH,IAAA,aAAc,OAAM,GAAG;AAAA,GACzC;AAED,YAAgB,MAAA;QACV,gBAAiB,iBAAA;AAAA,GACtB;;AAGK,QAAA;AACS,UAAA,OAAA,WAAW,aAAa;AACjC,qBAAa,QAAQ,eAAe,KAAK,UAAAC,IAAU,aAAa,CAAA,CAAA;AAAA,MAClE;AAAA,IACF,SAAS,GAAG;AACV,cAAQ,MAAM,uBAAuB,CAAC;AAAA,IACxC;AAAA;;;AAII,QAAA;UACF,gBAAeC,iBAAI,IAAI,MAARA,mBAAW,QAAXA,mBAAgB,aAAY,IAAI,MAAM,GAAG,EAAE,CAAC,CAAA;AAAA,IAC7D,SAAS,GAAG;UACV,aAAc,EAAA;AACd,cAAQ,MAAM,qBAAqB,CAAC;AAAA,IACtC;AAAA;;QAGC,eAAgB,aAAa,aAAS,WAAW,CAAA,CAAA;AAAA;;;;;;;;;;;;;;;;;yBAS5B,aAAa;AAAA;;kBAAb,eAAa,OAAA;AAAA;;;;;;;;;uFACQ,aAAa,IAAG,UAAU,OAAO,EAAA,CAAA;;;;;;;;;;;;;gBAFpEA,MAAI,IAAI,KAAA,CAAAD,IAAM,aAAa,EAAA,UAAA,YAAA;AAAA,gBAAA,UAAA,aAAA,KAAA;AAAA;;;;;;eAJ/B,WAAW,KAAIC,MAAI,SAAS,EAAA,UAAA,UAAA;AAAA,UAAA,UAAA,WAAA,KAAA;AAAA;;;;;;"}